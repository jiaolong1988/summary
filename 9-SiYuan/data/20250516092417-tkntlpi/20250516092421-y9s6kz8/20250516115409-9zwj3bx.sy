{"ID":"20250516115409-9zwj3bx","Spec":"1","Type":"NodeDocument","Properties":{"id":"20250516115409-9zwj3bx","title":"存储数据和建立索引的区别","type":"doc","updated":"20250516144755"},"Children":[{"ID":"20250516143428-qvmc16q","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250516143428-qvmc16q","updated":"20250516115516"},"Children":[{"Type":"NodeText","Data":"聚簇索引区别"}]},{"ID":"20250516115409-k3qanxq","Type":"NodeList","ListData":{},"Properties":{"id":"20250516115409-k3qanxq","updated":"20250516143454"},"Children":[{"ID":"20250516143454-oqdjdbm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516143454-oqdjdbm","updated":"20250516143454"},"Children":[{"ID":"20250516143454-1vm96f0","Type":"NodeParagraph","Properties":{"id":"20250516143454-1vm96f0","updated":"20250516143454"},"Children":[{"Type":"NodeText","Data":"MySQL的InnoDB是聚簇索引，数据和主键索引存一起，二级索引存主键。"}]}]}]},{"ID":"20250516115528-obh3xn2","Type":"NodeParagraph","Properties":{"id":"20250516115528-obh3xn2","updated":"20250516115541"},"Children":[{"Type":"NodeText","Data":"而Oracle的索引通常是非聚簇的，数据和索引分开存储，可能使用"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"堆表"},{"Type":"NodeText","Data":"或"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"索引组织表（IOT）"},{"Type":"NodeText","Data":"。需要明确两者的存储结构差异。"}]},{"ID":"20250516115516-igedb54","Type":"NodeParagraph","Properties":{"id":"20250516115516-igedb54","updated":"20250516115516"}},{"ID":"20250516144324-4ldv7l9","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250516144324-4ldv7l9","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"二、MySQL与Oracle存储/索引的核心区别"}]},{"ID":"20250516144324-6inz86m","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250516144324-6inz86m","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"1. 存储架构差异：聚簇索引 vs 非聚簇索引（默认模式）"}]},{"ID":"20250516144324-vd2pmec","Type":"NodeList","ListData":{},"Properties":{"id":"20250516144324-vd2pmec","updated":"20250516144324"},"Children":[{"ID":"20250516144324-775v2sn","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144324-775v2sn","updated":"20250516144324"},"Children":[{"ID":"20250516144324-j6b3na2","Type":"NodeParagraph","Properties":{"id":"20250516144324-j6b3na2","updated":"20250516144328"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"MySQL（InnoDB）"},{"Type":"NodeText","Data":"：\nInnoDB是"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"强制聚簇索引"},{"Type":"NodeText","Data":"的存储引擎。表数据必须按照主键的顺序物理存储（聚簇索引即数据本身），二级索引（如普通索引）的叶子节点存储的是主键值（而非数据行地址）。\n\n"}]}]},{"ID":"20250516144324-t39dba2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144324-t39dba2","updated":"20250516144324"},"Children":[{"ID":"20250516144324-s9iq91b","Type":"NodeParagraph","Properties":{"id":"20250516144324-s9iq91b","updated":"20250516144330"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"Oracle（默认堆表）"},{"Type":"NodeText","Data":"：\nOracle默认使用"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"非聚簇索引（堆表）"},{"Type":"NodeText","Data":"，数据行以无序方式存储在数据块中（类似“堆”），索引（包括主键索引）独立存储，索引叶子节点存储的是数据行的物理地址（ROWID）。"}]}]}]},{"ID":"20250516144331-xopemoy","Type":"NodeParagraph","Properties":{"id":"20250516144331-xopemoy","updated":"20250516144331"}},{"ID":"20250516144755-9rzd90g","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250516144755-9rzd90g","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"2. 索引实现细节差异"}]},{"ID":"20250516144755-qqdvbrg","Type":"NodeTable","TableAligns":[0,0,0],"Properties":{"colgroup":"width: 203px;|width: 423px;|","id":"20250516144755-qqdvbrg","updated":"20250516144755"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"特性"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"MySQL（InnoDB）"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"Oracle（B树索引）"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"索引与数据的关系"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"聚簇索引"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"="}]},{"Type":"NodeText","Data":"数据本身（主键）；二级索引→主键"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"所有索引独立于数据（索引→ROWID）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"叶子节点内容"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"主键索引：完整数据行；二级索引：主键值"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"所有索引叶子节点：索引键+对应数据行的ROWID"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"范围查询优化"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"叶子节点双向链表，范围查询直接遍历链表"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"叶子节点双向链表，支持范围扫描"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"索引高度控制"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"依赖页大小（默认16KB）和键长度"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"支持更灵活的块大小（可配置8KB/16KB/32KB）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"事务影响"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"索引更新与数据更新强绑定（因聚簇存储）"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"索引与数据独立更新，可能产生“索引碎片”"}]}]}]},{"ID":"20250516144755-27sooap","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250516144755-27sooap","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"3. 设计选择的底层原理"}]},{"ID":"20250516144755-3qh4m8d","Type":"NodeList","ListData":{},"Properties":{"id":"20250516144755-3qh4m8d","updated":"20250516144755"},"Children":[{"ID":"20250516144755-kkqpon9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144755-kkqpon9","updated":"20250516144755"},"Children":[{"ID":"20250516144755-6ga2nsv","Type":"NodeParagraph","Properties":{"id":"20250516144755-6ga2nsv","updated":"20250516144755"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"MySQL选择聚簇索引的原因"},{"Type":"NodeText","Data":"：\nInnoDB面向OLTP场景（高频增删改查），聚簇存储让“按主键查询”的效率极高（直接定位数据页），且二级索引通过主键回表的成本可控（主键通常较短）。但缺点是：主键修改会导致整行数据物理移动，非主键索引回表可能增加IO（尤其当主键很大时）。"}]}]},{"ID":"20250516144755-bu4926v","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144755-bu4926v","updated":"20250516144755"},"Children":[{"ID":"20250516144755-za5qmcw","Type":"NodeParagraph","Properties":{"id":"20250516144755-za5qmcw","updated":"20250516144755"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"Oracle默认非聚簇的原因"},{"Type":"NodeText","Data":"：\nOracle早期设计更注重多业务场景兼容性（OLTP/OLAP混合），堆表允许数据无序存储，适合频繁的非主键更新（无需移动数据）；独立索引结构便于维护（如重建索引不影响数据）。但缺点是：按主键查询需先查索引再找数据，可能多一次IO（但Oracle通过“索引组织表IOT”支持聚簇存储，可手动启用）。"}]},{"ID":"20250516145111-s61s0z5","Type":"NodeParagraph","Properties":{"id":"20250516145111-s61s0z5","updated":"20250516145111"}}]}]},{"ID":"20250516144755-wpb08hv","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250516144755-wpb08hv","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"三、聚簇索引的通俗解释"}]},{"ID":"20250516144755-yms3111","Type":"NodeParagraph","Properties":{"id":"20250516144755-yms3111","updated":"20250516144755"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"聚簇索引"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"="},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"数据行的“物理排序规则”"},{"Type":"NodeText","Data":"。\n想象你有一本字典："}]},{"ID":"20250516144755-xe2ws5y","Type":"NodeList","ListData":{},"Properties":{"id":"20250516144755-xe2ws5y","updated":"20250516144755"},"Children":[{"ID":"20250516144755-j32b8oj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144755-j32b8oj","updated":"20250516144755"},"Children":[{"ID":"20250516144755-9wpbpn4","Type":"NodeParagraph","Properties":{"id":"20250516144755-9wpbpn4","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"如果字典按“拼音”排序（聚簇索引是拼音），那么“找拼音为‘zhang’的字”时，只需要翻到对应页码，字已经按顺序排好（数据与索引物理绑定）。"}]}]},{"ID":"20250516144755-yoryrxg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144755-yoryrxg","updated":"20250516144755"},"Children":[{"ID":"20250516144755-n52mx05","Type":"NodeParagraph","Properties":{"id":"20250516144755-n52mx05","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"如果字典是“乱序”的（非聚簇），但有一张“拼音目录”（独立索引），目录里记录每个字的实际页码（ROWID），查“zhang”时需要先看目录，再按目录找字（两次操作）。"}]}]}]},{"ID":"20250516144755-yoebsjl","Type":"NodeParagraph","Properties":{"id":"20250516144755-yoebsjl","updated":"20250516144755"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"关键特征"},{"Type":"NodeText","Data":"："}]},{"ID":"20250516144755-ach6b0h","Type":"NodeList","ListData":{},"Properties":{"id":"20250516144755-ach6b0h","updated":"20250516144755"},"Children":[{"ID":"20250516144755-clctwly","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144755-clctwly","updated":"20250516144755"},"Children":[{"ID":"20250516144755-lbs5ywv","Type":"NodeParagraph","Properties":{"id":"20250516144755-lbs5ywv","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"一个表最多只有1个聚簇索引（因为数据只能按一种物理顺序存储）。"}]}]},{"ID":"20250516144755-t5ls558","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144755-t5ls558","updated":"20250516144755"},"Children":[{"ID":"20250516144755-yq57mj4","Type":"NodeParagraph","Properties":{"id":"20250516144755-yq57mj4","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"聚簇索引的顺序直接决定数据在磁盘上的存储顺序（类似“书的正文按目录顺序印刷”）。"}]}]}]},{"ID":"20250516144755-zn2flj7","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250516144755-zn2flj7","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"总结"}]},{"ID":"20250516144755-8lwgq8a","Type":"NodeParagraph","Properties":{"id":"20250516144755-8lwgq8a","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"MySQL（InnoDB）与Oracle的索引差异本质是"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"存储架构选择"},{"Type":"NodeText","Data":"的结果："}]},{"ID":"20250516144755-fxjtwfx","Type":"NodeList","ListData":{},"Properties":{"id":"20250516144755-fxjtwfx","updated":"20250516144755"},"Children":[{"ID":"20250516144755-niobyt4","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144755-niobyt4","updated":"20250516144755"},"Children":[{"ID":"20250516144755-rh98iwl","Type":"NodeParagraph","Properties":{"id":"20250516144755-rh98iwl","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"MySQL通过聚簇索引+主键绑定优化OLTP场景的主键查询；"}]}]},{"ID":"20250516144755-2f991w1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250516144755-2f991w1","updated":"20250516144755"},"Children":[{"ID":"20250516144755-8cwszjv","Type":"NodeParagraph","Properties":{"id":"20250516144755-8cwszjv","updated":"20250516144755"},"Children":[{"Type":"NodeText","Data":"Oracle通过独立索引+堆表设计兼容更多业务场景（可通过IOT手动实现聚簇）。\n两者的索引结构（B+树变种）在原理上是一致的，差异主要体现在“索引与数据的绑定关系”和“具体实现优化”上。"}]}]}]}]}